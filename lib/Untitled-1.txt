import 'dart:io';

Future main() async {
  final server = await HttpServer.bind(InternetAddress.loopbackIPv4, 8080);
  print('Server listening on localhost:${server.port}');

  await for (HttpRequest request in server) {
    request.response.headers.add('Access-Control-Allow-Origin', '*');
    request.response.headers
        .add('Access-Control-Allow-Headers', 'Origin, Content-Type');

    final response = await handleRequest(request);
    request.response
      ..statusCode = response.statusCode
      ..headers.addAll(response.headers)
      ..write(response.body)
      ..close();
  }
}

Future<HttpResponse> handleRequest(HttpRequest request) async {
  // handle request logic here
  final response = HttpResponse();
  response.statusCode = HttpStatus.ok;
  response.headers.contentType = ContentType.text;
  response.write('Hello World');
  return response;
}
